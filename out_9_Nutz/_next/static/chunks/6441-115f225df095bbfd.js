"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6441],{554:function(t,e,r){r.r(e),r.d(e,{default:function(){return d}});var n=r(7437),a=r(2265),i=r(1396),o=r.n(i);r(8207);var s=r(8822),c=r(2601);let l="https://9nutsapi.nearbydoctors.in/public/api";function u(t){if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://")||t.startsWith("data:"))return t;let e=(c.env.NEXT_PUBLIC_API_BASE||"").replace(/\/+$/,"");return e?t.startsWith("/")?"".concat(e).concat(t):"".concat(e,"/").concat(t):t}function d(t){var e;let{identifier:r}=t,[i,c]=(0,a.useState)(!0),[d,m]=(0,a.useState)(null),[h,f]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),{addItem:y,openCart:v}=(0,s.useCart)()||{},x=(0,a.useCallback)(t=>{var e;if(!t)return;let r=Number(null!==(e=null==t?void 0:t.stock)&&void 0!==e?e:1/0);if(Number.isNaN(r)||!(r<=0)){g(!0);try{"function"==typeof y?y({...t,quantity:1}):window.dispatchEvent(new CustomEvent("productAddToCart",{detail:{product:t,quantity:1}})),"function"==typeof v?v():window.dispatchEvent(new CustomEvent("openCart"))}catch(t){}finally{setTimeout(()=>g(!1),600)}}},[y,v,g]);if((0,a.useEffect)(()=>{if(!r){m("No category identifier provided"),c(!1);return}let t=!1;return(async()=>{async function e(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let r=await fetch(t,{...e,headers:{"Content-Type":"application/json"}}),n=await r.text();try{let t=JSON.parse(n||"{}");return{ok:r.ok,status:r.status,json:t}}catch(t){return{ok:r.ok,status:r.status,json:null,raw:n}}}catch(t){return{ok:!1,error:t}}}c(!0),m(null),f(null);try{var n;let a="".concat(l,"/online-categories/show-category/").concat(encodeURIComponent(r)),i=await e(a);if(t)return;if(i.ok&&i.json&&i.json.data){f(i.json.data),c(!1);return}let o=await e("".concat(l,"/category/show"));if(t)return;let s=Array.isArray(null===(n=o.json)||void 0===n?void 0:n.data)?o.json.data:[],u=String(r).match(/^\d+$/)?Number(r):null,d=null;if(null!==u&&(d=s.find(t=>Number(t.id)===u)),!d){let t=String(r).toLowerCase();d=s.find(e=>{var r,n,a;let i=(null!==(r=e.slug)&&void 0!==r?r:"").toLowerCase(),o=(null!==(a=null!==(n=e.name)&&void 0!==n?n:e.title)&&void 0!==a?a:"").toLowerCase();return i===t||o===t})}if(d){let r="".concat(l,"/online-categories/show-category/").concat(d.id),n=await e(r);if(t)return;if(n.ok&&n.json&&n.json.data){f(n.json.data),c(!1);return}f(d),c(!1);return}throw Error("Category not found by identifier")}catch(e){t||(m((null==e?void 0:e.message)||String(e)),c(!1))}})(),()=>{t=!0}},[r]),i)return(0,n.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,n.jsx)("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-emerald-500 rounded-full animate-spin"})});if(d)return(0,n.jsxs)("div",{className:"py-12 text-center text-red-600",children:["Error: ",d]});if(!h)return(0,n.jsx)("div",{className:"py-12 text-center text-gray-500",children:"Category not found"});let b=Array.isArray(h.products)?h.products:[];return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 ",children:[(0,n.jsxs)("div",{className:"flex items-center gap-6 mb-6",children:[h.image_url?(0,n.jsx)("img",{src:h.image_url,alt:h.name,className:"w-28 h-28 object-cover rounded-md shadow"}):h.image?(0,n.jsx)("img",{src:u(h.image),alt:h.name,className:"w-28 h-28 object-cover rounded-md shadow"}):null,(0,n.jsx)("div",{children:(0,n.jsx)("h1",{className:"text-2xl font-bold",children:null!==(e=h.name)&&void 0!==e?e:h.title})})]}),(0,n.jsx)("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:0===b.length?(0,n.jsx)("div",{className:"col-span-full text-center text-gray-500 py-6",children:"No products in this category."}):b.map(t=>{var e,r,a,i;let s=String(null!==(a=null!==(r=null!==(e=t.id)&&void 0!==e?e:t.product_id)&&void 0!==r?r:t._id)&&void 0!==a?a:"");return(0,n.jsx)("article",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,n.jsxs)(o(),{href:s?"/product/".concat(s):"#",className:"block",prefetch:!1,children:[(0,n.jsx)("div",{className:"w-full h-48 bg-gray-100 overflow-hidden flex items-center justify-center",children:(0,n.jsx)("img",{src:t.image_url||(t.image?u(t.image):""),alt:t.name,className:"w-full h-full object-cover"})}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:t.name}),(0,n.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[t.grams," g"]}),(0,n.jsx)("div",{className:"mt-2 flex items-baseline justify-between",children:(0,n.jsxs)("span",{className:"text-lg font-bold",children:["â‚¹",null!==(i=t.discount_price)&&void 0!==i?i:t.price]})}),(0,n.jsx)("button",{type:"button",onClick:e=>{e.preventDefault(),Number(t.stock)>0&&x(t)},disabled:0>=Number(t.stock),className:"mt-3 w-full text-sm font-medium py-2 rounded-md transition ".concat(Number(t.stock)>0?"bg-emerald-600 hover:bg-emerald-700 text-white":"bg-gray-300 text-gray-600 cursor-not-allowed"),children:0>=Number(t.stock)?"Out of Stock":p?"Adding...":"Add to Cart"})]})]})},s||Math.random())})})]})})}},8822:function(t,e,r){r.r(e),r.d(e,{CartProvider:function(){return o},useCart:function(){return s}});var n=r(7437),a=r(2265);let i=(0,a.createContext)(null);function o(t){let{children:e}=t,[r,o]=(0,a.useState)(()=>{try{let t=localStorage.getItem("cart_v1");return t?JSON.parse(t):[]}catch(t){return[]}});(0,a.useEffect)(()=>{try{localStorage.setItem("cart_v1",JSON.stringify(r))}catch(t){}},[r]);let s=(0,a.useCallback)(t=>{var e;if(!t||!t.id)return;let r=Math.max(1,Number(null!==(e=t.quantity)&&void 0!==e?e:1));o(e=>{let n=e.findIndex(e=>e.id===t.id);if(n>=0){let t=[...e];return t[n]={...t[n],quantity:(Number(t[n].quantity)||0)+r},t}return[...e,{...t,quantity:r}]})},[]),c=(0,a.useCallback)(t=>{o(e=>e.filter(e=>e.id!==t))},[]),l=(0,a.useCallback)((t,e)=>{let r=Math.trunc(Number(e)||0);o(e=>r<=0?e.filter(e=>e.id!==t):e.map(e=>e.id===t?{...e,quantity:r}:e))},[]),u=(0,a.useCallback)(()=>o([]),[]),d=r.reduce((t,e)=>t+(Number(e.quantity)||0),0),m=r.reduce((t,e)=>t+(Number(e.price)||0)*(Number(e.quantity)||0),0);return(0,n.jsx)(i.Provider,{value:{items:r,addItem:s,removeItem:c,updateQuantity:l,clearCart:u,cartCount:d,cartTotal:m},children:e})}function s(){let t=(0,a.useContext)(i);if(!t)throw Error("useCart must be used within CartProvider");return t}},8207:function(t,e,r){r.d(e,{DI:function(){return u},I:function(){return s},Sg:function(){return i},_g:function(){return c},bA:function(){return d},kE:function(){return o},nm:function(){return m}});var n=r(4829),a=r(2601);let i=(a.env.NEXT_PUBLIC_API_BASE||"https://ecom.nearbydoctors.in").replace(/\/+$/,""),o=(a.env.NEXT_PUBLIC_API_BASE_URL||"https://api.9nutz.com/api").replace(/\/+$/,""),s="https://9nutsapi.nearbydoctors.in/public/api".replace(/\/+$/,""),c="https://checkout.razorpay.com/v1/checkout.js";async function l(t){var e;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(t){if(!t)return i;if(/^https?:\/\//i.test(t))return t;let e=String(t).replace(/^\/+/,"");return"".concat(i,"/").concat(e)}(t),a={method:r.method||"GET",headers:{...r.headers||{}},credentials:null!==(e=r.credentials)&&void 0!==e?e:"same-origin"};void 0!==r.body&&(a.headers={...a.headers||{},"Content-Type":"application/json"},a.body=JSON.stringify(r.body)),r.token&&(a.headers={...a.headers||{},Authorization:"Bearer ".concat(r.token)});let o=await fetch(n,a),s=await o.text(),c=null;try{c=s?JSON.parse(s):null}catch(t){c=s}if(!o.ok){let t=(null==c?void 0:c.message)||c||o.statusText,e=Error(String(t));throw e.status=o.status,e.body=c,e}return c}let u=(t,e)=>l("/api/admin/categories",{method:"POST",body:t,token:e}),d=(t,e,r)=>l("/api/admin/categories/".concat(t),{method:"PUT",body:e,token:r}),m=(t,e)=>l("/api/admin/categories/".concat(t),{method:"DELETE",token:e}),h=n.Z.create({baseURL:o,headers:{"Content-Type":"application/json"}});h.interceptors.request.use(t=>{{let e=window.localStorage.getItem("token");e&&(t.headers.Authorization="Bearer ".concat(e))}return t},t=>Promise.reject(t)),h.interceptors.response.use(t=>t,t=>Promise.reject(t)),e.ZP=h}}]);