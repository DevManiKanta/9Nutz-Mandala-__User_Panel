"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9100],{6141:function(e,s,t){t.d(s,{Z:function(){return l}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,a.Z)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4322:function(e,s,t){t.d(s,{Z:function(){return l}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,a.Z)("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]])},1827:function(e,s,t){t.d(s,{Z:function(){return l}});var a=t(5531);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let l=(0,a.Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9100:function(e,s,t){t.r(s),t.d(s,{default:function(){return x}});var a=t(7437),l=t(2265),r=t(1827),i=t(6141),n=t(4322),d=t(2549),c=t(5925),o=t(8207);function x(e){var s,t,x,m,u,h,p,g,y,j,v,N,b,f;let{initialOrders:w=[]}=e,[_,k]=(0,l.useState)(null),[S,A]=(0,l.useState)(Array.isArray(w)?w:[]),[C,Z]=(0,l.useState)(!1),[T,q]=(0,l.useState)(""),[M,F]=(0,l.useState)(1),[L,O]=(0,l.useState)(null),E=()=>localStorage.getItem("token")||"",P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,s=E();if(!s){c.toast.error("Not logged in — token missing.");return}Z(!0);let t=c.toast.loading("Loading orders...");try{var a;let l="".concat(o.I,"/admin/online-orders/user?page=").concat(e,"&per_page=5"),r=await fetch(l,{method:"GET",headers:{Accept:"application/json",Authorization:"Bearer ".concat(s)}}),i=await r.json().catch(()=>null);if(!r.ok){let e=(null==i?void 0:i.message)||"Failed to fetch orders (".concat(r.status,")");throw c.toast.error(e),Error(e)}let n=i&&i.data&&Array.isArray(i.data.data)?i.data.data:Array.isArray(i)?i:[];A(n),k(null!==(a=null==i?void 0:i.data)&&void 0!==a?a:null),F(e),c.toast.dismiss(t)}catch(e){c.toast.dismiss(),c.toast.error((null==e?void 0:e.message)||"Failed to load orders")}finally{Z(!1)}};(0,l.useEffect)(()=>{P(1)},[]);let I=e=>{if(!e)return[];try{if("string"==typeof e){let s=e.trim();if(!s)return[];return JSON.parse(s)}if(Array.isArray(e))return e}catch(e){}return[]},V=(0,l.useMemo)(()=>(S||[]).map(e=>{var s,t,a,l,r,i,n,d,c,o,x,m,u,h,p;let g=I(e.items),y=g.length>0?g[0]:null,j=null!==(s=null==y?void 0:y.image)&&void 0!==s?s:null;return{key:"order-".concat(e.id),raw:e,id:e.id,customer_name:null!==(t=e.customer_name)&&void 0!==t?t:"—",image:j,total:null!==(a=e.total)&&void 0!==a?a:"—",payment:null!==(l=e.payment)&&void 0!==l?l:"—",order_time:null!==(n=null!==(i=null!==(r=e.order_time)&&void 0!==r?r:e.created_at)&&void 0!==i?i:e.order_time_formatted)&&void 0!==n?n:null,address:null!==(d=e.address)&&void 0!==d?d:"—",items:g,status:null!==(c=e.status)&&void 0!==c?c:null,awb_number:null!==(o=e.awb_number)&&void 0!==o?o:null,tracking_id:null!==(x=e.tracking_id)&&void 0!==x?x:null,shipping_url:null!==(m=e.shipping_url)&&void 0!==m?m:null,subtotal:null!==(u=e.subtotal)&&void 0!==u?u:null,gst_amount:null!==(h=e.gst_amount)&&void 0!==h?h:null,discount_value:null!==(p=e.discount_value)&&void 0!==p?p:null}}),[S]),z=(0,l.useMemo)(()=>{let e=String(T||"").trim().toLowerCase();return e?V.filter(s=>String(s.customer_name||"").toLowerCase().includes(e)):V},[V,T]),B=e=>{if(!e)return"—";try{let s=new Date(e);if(!isNaN(s.getTime()))return s.toLocaleString();return String(e)}catch(s){return String(e)}};return(0,a.jsxs)("div",{className:"space-y-6 w-full",children:[(0,a.jsx)(c.Toaster,{position:"top-right",reverseOrder:!1}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"My Orders"}),(0,a.jsxs)("div",{className:"relative w-full sm:max-w-sm",children:[(0,a.jsx)(r.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search by customer name...",value:T,onChange:e=>q(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent","aria-label":"Search orders by customer name"})]})]}),C?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(i.Z,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading orders…"})]}):0===V.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(n.Z,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders yet"}),(0,a.jsx)("p",{className:"text-gray-500",children:"Your order history will appear here"})]}):0===z.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(r.Z,{className:"h-10 w-10 text-gray-400 mx-auto mb-3"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No customers match your search."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"overflow-x-auto rounded-xl border border-gray-200 bg-white",children:(0,a.jsxs)("table",{className:"min-w-[700px] w-full text-left",children:[(0,a.jsx)("thead",{className:"bg-gray-50 text-gray-600 text-xs uppercase tracking-wide",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-4 py-3",children:"Customer"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Image"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Total"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Payment"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Ordered On"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Address"}),(0,a.jsx)("th",{className:"px-4 py-3",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-100 text-sm",children:z.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50/60",children:[(0,a.jsx)("td",{className:"px-4 py-3 font-medium text-gray-900",children:e.customer_name}),(0,a.jsx)("td",{className:"px-4 py-3",children:e.image?(0,a.jsx)("img",{src:e.image,alt:"".concat(e.customer_name," product"),className:"h-12 w-12 rounded-lg object-cover border"}):(0,a.jsx)("div",{className:"h-12 w-12 rounded-lg bg-gray-100 border"})}),(0,a.jsx)("td",{className:"px-4 py-3 font-semibold text-gray-900",children:"string"!=typeof e.total||isNaN(Number(e.total))?e.total:"₹".concat(Number(e.total).toFixed(2))}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-700",children:e.payment}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-700",children:B(e.order_time)}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-700",children:e.address}),(0,a.jsx)("td",{className:"px-4 py-3",children:(0,a.jsx)("div",{className:"flex gap-2",children:(0,a.jsx)("button",{onClick:()=>O(e.raw),className:"inline-flex items-center gap-2 px-3 py-1 rounded border text-sm text-indigo-600 hover:bg-indigo-50",children:"View"})})})]},e.key))}),(0,a.jsx)("tfoot",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:(0,a.jsxs)("td",{className:"px-4 py-3 text-xs text-gray-500",colSpan:7,children:["Showing ",z.length," order",z.length>1?"s":"","."]})})})]})}),(()=>{var e,s,t,l,r,i;if(!_)return null;let n=null!==(e=_.current_page)&&void 0!==e?e:M,d=null!==(s=_.last_page)&&void 0!==s?s:null;return(0,a.jsxs)("nav",{className:"flex items-center justify-between px-4 py-3 bg-white border-t sm:px-6","aria-label":"Pagination",children:[(0,a.jsx)("div",{className:"hidden sm:block",children:(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,a.jsx)("span",{className:"font-medium",children:null!==(t=_.from)&&void 0!==t?t:1})," to"," ",(0,a.jsx)("span",{className:"font-medium",children:null!==(l=_.to)&&void 0!==l?l:V.length})," of"," ",(0,a.jsx)("span",{className:"font-medium",children:null!==(r=_.total)&&void 0!==r?r:V.length})," results"]})}),(0,a.jsxs)("div",{className:"flex-1 flex items-center justify-center sm:justify-end gap-1",children:[(0,a.jsx)("button",{onClick:()=>P(Math.max(1,n-1)),disabled:!_.prev_page_url,className:"px-3 py-1 rounded border bg-white text-sm disabled:opacity-50",children:"Prev"}),(()=>{let e=[],s=1,t=null!=d?d:n;d&&d>7&&(t=Math.min(d,(s=Math.max(1,n-3))+6))-s<6&&(s=Math.max(1,t-6));for(let l=s;l<=t;l++)e.push((0,a.jsx)("button",{onClick:()=>P(l),className:"px-3 py-1 rounded border text-sm ".concat(l===n?"bg-emerald-600 text-white":"bg-white"),children:l},l));return e})(),(0,a.jsx)("button",{onClick:()=>P((null!==(i=_.current_page)&&void 0!==i?i:M)+1),disabled:!_.next_page_url,className:"px-3 py-1 rounded border bg-white text-sm disabled:opacity-50",children:"Next"})]})]})})()]}),L&&(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:()=>O(null)}),(0,a.jsxs)("div",{className:"relative bg-white rounded-xl shadow-2xl w-full max-w-3xl p-4 z-10",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold",children:["Order #",L.id," ",(0,a.jsxs)("span",{className:"ml-2 text-sm font-medium text-gray-500",children:[" • ",null!==(s=L.status)&&void 0!==s?s:"Status N/A"]})]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["Customer: ",L.customer_name]})]}),(0,a.jsx)("button",{onClick:()=>O(null),className:"rounded-md p-1 hover:bg-gray-100",children:(0,a.jsx)(d.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Items"}),(0,a.jsx)("div",{className:"space-y-3",children:0===I(L.items).length?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"No items found"}):I(L.items).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded",children:[(0,a.jsx)("div",{className:"flex-shrink-0 h-16 w-16",children:e.image?(0,a.jsx)("img",{src:e.image,alt:e.name,className:"h-16 w-16 object-cover rounded"}):(0,a.jsx)("div",{className:"h-16 w-16 bg-gray-100 rounded"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["Qty: ",null!==(x=null!==(t=e.quantity)&&void 0!==t?t:e.qty)&&void 0!==x?x:1]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold",children:["₹",null!==(u=null!==(m=e.price_rupees)&&void 0!==m?m:e.price)&&void 0!==u?u:e.price_paise?(Number(e.price_paise)/100).toFixed(2):"—"]}),(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["Total: ₹",(e.quantity||e.qty)&&e.price_rupees?(Number(e.price_rupees)*Number(e.quantity||e.qty)).toFixed(2):"—"]})]})]},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 mb-2",children:"Summary"}),(0,a.jsxs)("div",{className:"space-y-2 bg-gray-50 p-3 rounded",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,a.jsx)("span",{children:"Subtotal"}),(0,a.jsxs)("span",{children:["₹",null!==(p=null!==(h=L.subtotal)&&void 0!==h?h:L.total)&&void 0!==p?p:"—"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,a.jsx)("span",{children:"GST"}),(0,a.jsxs)("span",{children:["₹",null!==(g=L.gst_amount)&&void 0!==g?g:"0.00"]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-gray-700",children:[(0,a.jsx)("span",{children:"Discount"}),(0,a.jsxs)("span",{children:["- ₹",null!==(y=L.discount_value)&&void 0!==y?y:"0.00"]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold text-gray-900",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["₹",null!==(j=L.total)&&void 0!==j?j:"—"]})]}),(0,a.jsxs)("div",{className:"pt-3 border-t",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Payment"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:L.payment})]}),(0,a.jsxs)("div",{className:"pt-3 border-t",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Tracking details"}),(0,a.jsx)("div",{className:"text-sm text-gray-900 space-y-1",children:"Shipping"===L.status?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"AWB / Tracking"}),(0,a.jsx)("div",{children:null!==(N=null!==(v=L.awb_number)&&void 0!==v?v:L.tracking_id)&&void 0!==N?N:"—"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs text-gray-500",children:"Tracking URL"}),(0,a.jsx)("div",{children:L.shipping_url?(0,a.jsx)("a",{href:L.shipping_url,target:"_blank",rel:"noreferrer",className:"text-emerald-600 underline",children:"View tracking"}):"—"})]})]}):(0,a.jsx)("div",{children:L.shipping_url?(0,a.jsx)("a",{href:L.shipping_url,target:"_blank",rel:"noreferrer",className:"text-emerald-600 underline",children:"View tracking"}):null!==(f=null!==(b=L.awb_number)&&void 0!==b?b:L.tracking_id)&&void 0!==f?f:"—"})})]}),(0,a.jsxs)("div",{className:"pt-3 border-t",children:[(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Address"}),(0,a.jsx)("div",{className:"text-sm text-gray-900",children:L.address})]})]})]})]}),(0,a.jsx)("div",{className:"mt-4 flex justify-end",children:(0,a.jsx)("button",{onClick:()=>O(null),className:"px-4 py-2 rounded border",children:"Close"})})]})]})]})}}}]);