(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{5994:function(e,t,r){Promise.resolve().then(r.t.bind(r,8877,23)),Promise.resolve().then(r.bind(r,242)),Promise.resolve().then(r.bind(r,5268)),Promise.resolve().then(r.bind(r,2502)),Promise.resolve().then(r.bind(r,8822)),Promise.resolve().then(r.bind(r,1157)),Promise.resolve().then(r.bind(r,81)),Promise.resolve().then(r.bind(r,1828)),Promise.resolve().then(r.bind(r,4232)),Promise.resolve().then(r.bind(r,2080)),Promise.resolve().then(r.bind(r,5884)),Promise.resolve().then(r.bind(r,5925))},242:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var a=r(7437),i=r(2265),n=r(8164),s=r(6658),o=r(6476),d=r(7516),u=r(8822);function l(e){let{children:t}=e,{items:r,updateQuantity:l,clearCart:c,cartCount:m,cartTotal:f}=(0,u.useCart)(),[h,g]=(0,i.useState)(!1),[p,v]=(0,i.useState)(!1),[D,w]=(0,i.useState)(!1),y=(0,i.useCallback)(()=>g(!0),[]),S=(0,i.useCallback)(()=>g(!1),[]);return(0,i.useEffect)(()=>{let e=()=>g(!0);return window.addEventListener("openCart",e),()=>window.removeEventListener("openCart",e)},[]),(0,i.useEffect)(()=>{w(!0)},[]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.default,{onCartClick:y,onLoginClick:()=>v(!0),cartItemCount:m,cartTotal:f}),(0,a.jsx)("main",{className:"min-h-screen",children:t}),(0,a.jsx)(s.default,{}),D&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{isOpen:h,onClose:S,items:r,onUpdateQuantity:l,onClearCart:c}),(0,a.jsx)(d.Z,{isOpen:p,onClose:()=>v(!1)})]})]})}},5268:function(e,t,r){"use strict";r.r(t),r.d(t,{AddressProvider:function(){return d},useAddresses:function(){return s}});var a=r(7437),i=r(2265);let n=(0,i.createContext)(void 0),s=()=>{let e=(0,i.useContext)(n);if(!e)throw Error("useAddresses must be used within an AddressProvider");return e},o=[{id:"addr-1",userId:"user-1",type:"Home",name:"John Doe",address:"B62, Pocket B, Sector 7, Rohini, Delhi - 110085",phone:"+91 9876543210",isDefault:!0},{id:"addr-2",userId:"user-1",type:"Work",name:"John Doe",address:"Connaught Place, New Delhi - 110001",phone:"+91 9876543210"}],d=e=>{let{children:t}=e,[r,s]=(0,i.useState)(o);(0,i.useEffect)(()=>{let e=localStorage.getItem("addresses");if(e)try{let t=JSON.parse(e);s([...o,...t])}catch(e){}},[]);let d=e=>{let t=e.filter(e=>!o.find(t=>t.id===e.id));localStorage.setItem("addresses",JSON.stringify(t))};return(0,a.jsx)(n.Provider,{value:{addresses:r,addAddress:e=>{let t={...e,id:"addr-".concat(Date.now())},a=[...r,t];s(a),d(a)},updateAddress:(e,t)=>{let a=r.map(r=>r.id===e?{...r,...t}:r);s(a),d(a)},deleteAddress:e=>{let t=r.filter(t=>t.id!==e);s(t),d(t)},getUserAddresses:e=>r.filter(t=>t.userId===e),setDefaultAddress:(e,t)=>{let a=r.map(r=>({...r,isDefault:r.userId===t?r.id===e:r.isDefault}));s(a),d(a)}},children:t})}},1157:function(e,t,r){"use strict";r.r(t),r.d(t,{CategoryProvider:function(){return c},useCategories:function(){return u}});var a=r(7437),i=r(2265),n=r(2502),s=function(){let{token:e}=(0,n.useAuth)(),t=(0,i.useCallback)(async function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];if(!e){let e=Error("Not authenticated (no token). Please login.");throw e.status=401,e}return t(...a,e)},[e]);return{call:t,token:e}},o=r(8207);let d=(0,i.createContext)(void 0),u=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useCategories must be used within a CategoryProvider");return e};function l(e){return{id:String(e.id),name:e.name,description:e.description||"",image:e.image_url||e.image||"",status:e.status||1===e.status?"active":"inactive",createdAt:e.created_at?new Date(e.created_at):new Date,updatedAt:e.updated_at?new Date(e.updated_at):new Date}}let c=e=>{let{children:t}=e,[r,u]=(0,i.useState)([]),[c,m]=(0,i.useState)(!0),[f,h]=(0,i.useState)(null),{token:g}=(0,n.useAuth)(),{call:p}=s();function v(e){u(e);try{localStorage.setItem("categories",JSON.stringify(e))}catch(e){}window.dispatchEvent(new CustomEvent("categoriesUpdated"))}async function D(){m(!0),h(null);try{let e=await getCategoriesPublicAPI(),t=Array.isArray(e)?e.map(l):[];v(t)}catch(e){throw h(String((null==e?void 0:e.message)||e)),e}finally{m(!1)}}async function w(e){try{if(!g)throw Error("Not authenticated. Please login as admin to add categories.");let t={name:e.name,description:e.description,image_url:e.image,status:e.status},a=await p(o.DI,t),i=l(a),n=[...r,i];v(n)}catch(e){throw e}}async function y(e,t){try{let a;if(!g)throw Error("Not authenticated. Please login as admin to update categories.");let i={name:t.name,description:t.description,image_url:t.image,status:t.status},n=await p(o.bA,Number(e),i);if(n)a=l(n);else{let i=r.find(t=>t.id===e);i&&(a={...i,...t,updatedAt:new Date})}if(a){let t=r.map(t=>t.id===e?a:t);v(t)}}catch(e){throw e}}async function S(e){try{if(!g)throw Error("Not authenticated. Please login as admin to delete categories.");await p(o.nm,Number(e));let t=r.filter(t=>t.id!==e);v(t)}catch(e){throw e}}return(0,i.useEffect)(()=>{let e=!1;return async function(){m(!0),h(null);try{let t=await getCategoriesPublicAPI();if(e)return;let r=Array.isArray(t)?t.map(l):[];u(r),localStorage.setItem("categories",JSON.stringify(r))}catch(t){let e=localStorage.getItem("categories");if(e)try{let t=JSON.parse(e).map(e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)}));u(t)}catch(e){u([])}else u([]);h(String((null==t?void 0:t.message)||t))}finally{e||m(!1)}}(),()=>{e=!0}},[]),(0,a.jsx)(d.Provider,{value:{categories:r,loading:c,error:f,addCategory:w,updateCategory:y,deleteCategory:S,getCategoryById:e=>r.find(t=>t.id===e),getActiveCategories:()=>r.filter(e=>"active"===e.status),refresh:D},children:t})}},1828:function(e,t,r){"use strict";r.r(t),r.d(t,{OrderProvider:function(){return d},useOrders:function(){return s}});var a=r(7437),i=r(2265);let n=(0,i.createContext)(void 0),s=()=>{let e=(0,i.useContext)(n);if(void 0===e)throw Error("useOrders must be used within an OrderProvider");return e},o=[{id:"order-1",userId:"user-1",items:[{id:"101",name:"Fresh Red Bananas",price:48,quantity:2,image:"https://images.pexels.com/photos/2238309/pexels-photo-2238309.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=1"}],total:96,status:"delivered",orderDate:new Date("2025-01-10"),deliveryAddress:{name:"John Doe",address:"B62, Pocket B, Sector 7, Rohini, Delhi - 110085",phone:"+91 9876543210"},estimatedDelivery:new Date("2025-01-10")},{id:"order-2",userId:"user-1",items:[{id:"201",name:"Amul Taaza Toned Milk",price:29,quantity:4,image:"https://images.pexels.com/photos/236010/pexels-photo-236010.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&dpr=1"}],total:116,status:"shipped",orderDate:new Date("2025-01-15"),deliveryAddress:{name:"John Doe",address:"B62, Pocket B, Sector 7, Rohini, Delhi - 110085",phone:"+91 9876543210"},estimatedDelivery:new Date("2025-01-16")}],d=e=>{let{children:t}=e,[r,s]=(0,i.useState)(o);return(0,i.useEffect)(()=>{let e=localStorage.getItem("orders");if(e){let t=JSON.parse(e).map(e=>({...e,orderDate:new Date(e.orderDate),estimatedDelivery:e.estimatedDelivery?new Date(e.estimatedDelivery):void 0}));s([...o,...t])}},[]),(0,a.jsx)(n.Provider,{value:{orders:r,addOrder:e=>{let t={...e,id:"order-".concat(Date.now()),orderDate:new Date},a=[...r,t];s(a);let i=a.filter(e=>!o.find(t=>t.id===e.id));localStorage.setItem("orders",JSON.stringify(i))},updateOrderStatus:(e,t)=>{let a=r.map(r=>r.id===e?{...r,status:t}:r);s(a);let i=a.filter(e=>!o.find(t=>t.id===e.id));localStorage.setItem("orders",JSON.stringify(i))},getUserOrders:e=>r.filter(t=>t.userId===e).sort((e,t)=>t.orderDate.getTime()-e.orderDate.getTime()),getAllOrders:()=>r.sort((e,t)=>t.orderDate.getTime()-e.orderDate.getTime()),getOrderStats:()=>{let e=new Date,t=new Date(e.getTime()-2592e6),a=new Date(e.getTime()-31536e6),i={};r.filter(e=>e.orderDate>=t).forEach(e=>{let t=e.orderDate.toISOString().split("T")[0];i[t]||(i[t]={count:0,revenue:0}),i[t].count++,i[t].revenue+=e.total});let n={};r.filter(e=>e.orderDate>=a).forEach(e=>{let t="".concat(e.orderDate.getFullYear(),"-").concat(String(e.orderDate.getMonth()+1).padStart(2,"0"));n[t]||(n[t]={count:0,revenue:0}),n[t].count++,n[t].revenue+=e.total});let s={};return r.forEach(e=>{e.items.forEach(e=>{s[e.id]||(s[e.id]={itemName:e.name,count:0}),s[e.id].count+=e.quantity})}),{daily:Object.entries(i).map(e=>{let[t,r]=e;return{date:t,count:r.count,revenue:r.revenue}}),monthly:Object.entries(n).map(e=>{let[t,r]=e;return{month:t,count:r.count,revenue:r.revenue}}),itemFrequency:Object.entries(s).map(e=>{let[t,r]=e;return{itemId:t,itemName:r.itemName,count:r.count}})}}},children:t})}},8877:function(){}},function(e){e.O(0,[4737,1396,7037,7243,5884,6658,8164,4232,8987,2971,7864,1744],function(){return e(e.s=5994)}),_N_E=e.O()}]);